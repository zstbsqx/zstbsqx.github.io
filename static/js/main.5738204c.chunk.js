(this["webpackJsonpconvert-numbers"]=this["webpackJsonpconvert-numbers"]||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),l=n(29),s=n.n(l),u=n(70),r=n(45),o=n(46),i=n(12),d=n(163),b=n(164),j=n(162),h=n(158),O=n(161),f=n(159),v=n(157),m=n(154),x=n(153),g=n(155),p=n(33),F=n.n(p),y=n(71),E=n.n(y),C=n(2),D=Object(g.a)({button:{height:"100%",contained:!0}});function S(e){var t=e.setWorkbook,n=e.setFilename,a=D(),l=Object(c.useState)("\u9009\u62e9\u8981\u8f6c\u6362\u7684Excel\u6587\u4ef6"),s=Object(i.a)(l,2),u=s[0],r=s[1];return Object(C.jsxs)(O.a,{container:!0,spacing:2,children:[Object(C.jsx)(O.a,{item:!0,xs:10,children:Object(C.jsx)(j.a,{value:u,inputProps:{style:{padding:"16.5px 14px"}},readOnly:!0,disableUnderline:!0,fullWidth:!0})}),Object(C.jsx)(O.a,{item:!0,xs:2,children:Object(C.jsxs)(d.a,{variant:"contained",component:"label",className:a.button,fullWidth:!0,children:["\u4e0a\u4f20",Object(C.jsx)("input",{type:"file",accept:".xls,.xlsx",onChange:function(e){if(0!==e.target.files.length){var c=e.target.files[0];n(c.name);var a=new FileReader;a.onload=function(e){var n=e.target.result,a=F.a.read(n,{type:"array"});r("".concat(c.name," \u4e0a\u4f20\u5b8c\u6bd5")),t(a)},r("".concat(c.name," \u4e0a\u4f20\u4e2d...")),a.readAsArrayBuffer(c)}},hidden:!0})]})})]})}function w(e){var t=e.sheets,n=e.onChange,a=Object(c.useState)(),l=Object(i.a)(a,2),s=l[0],u=l[1],r=t.includes(s)?s:t[0];return Object(c.useEffect)((function(){s!==r&&u(r)}),[s,r]),Object(c.useEffect)((function(){void 0!==r&&n(r)}),[r,n]),void 0===r?Object(C.jsxs)(h.a,{fullWidth:!0,children:[Object(C.jsx)(f.a,{id:"sheet-select-label",children:"\u5de5\u4f5c\u8868"}),Object(C.jsx)(m.a,{labelId:"sheet-select-label",label:"\u5de5\u4f5c\u8868",value:"dummy",disabled:!0,children:Object(C.jsx)(v.a,{value:"dummy",children:"\u6ca1\u6709\u6709\u6548\u7684\u5de5\u4f5c\u8868\uff0c\u8bf7\u5148\u4e0a\u4f20\u5408\u6cd5\u7684Excel\u6587\u4ef6"},0)})]}):Object(C.jsxs)(h.a,{fullWidth:!0,children:[Object(C.jsx)(f.a,{id:"sheet-select-label",children:"\u5de5\u4f5c\u8868"}),Object(C.jsx)(m.a,{labelId:"sheet-select-label",label:"\u5de5\u4f5c\u8868",value:r,onChange:function(e){return u(e.target.value)},children:t.map((function(e,t){return Object(C.jsx)(v.a,{value:e,children:e},t)}))})]})}function k(e){var t=e.columns,n=e.onChange,a=Object(c.useState)([]),l=Object(i.a)(a,2),s=l[0],u=l[1];return Object(c.useEffect)((function(){n(s)}),[n,s]),0===t.length?Object(C.jsxs)(h.a,{children:[Object(C.jsx)(f.a,{id:"column-select-label",children:"\u8981\u8f6c\u6362\u7684\u5217"}),Object(C.jsx)(m.a,{labelId:"column-select-label",label:"\u8981\u8f6c\u6362\u7684\u5217",multiple:!0,value:["dummy"],disabled:!0,children:Object(C.jsx)(v.a,{value:"dummy",children:"\u6ca1\u6709\u53ef\u7528\u7684\u5217\uff0c\u8bf7\u5148\u9009\u62e9\u53ef\u7528\u7684\u5de5\u4f5c\u8868"},0)})]}):Object(C.jsxs)(h.a,{children:[Object(C.jsx)(f.a,{id:"column-select-label",children:"\u8981\u8f6c\u6362\u7684\u5217"}),Object(C.jsx)(m.a,{labelId:"column-select-label",label:"\u8981\u8f6c\u6362\u7684\u5217",multiple:!0,value:s,onChange:function(e){return u(e.target.value)},children:t.map((function(e){return Object(C.jsx)(v.a,{value:e,children:e.text},e.id)}))})]})}var B=new(function(){function e(){Object(r.a)(this,e),this.columns_map=new Map}return Object(o.a)(e,[{key:"get",value:function(e){console.log("start getting table headers");var t=this.columns_map.get(e);if(void 0!==t)return console.log("Cached!",t),t;console.log("Missed cache!",e);for(var n=[],c=F.a.utils.decode_range(e["!ref"]),a=c.s.c;a<=c.e.c;++a){var l=e[F.a.utils.encode_cell({c:a,r:c.s.r})];void 0!==l&&void 0!==l.w&&n.push({id:a,text:l.w})}return console.log("Result",n),this.columns_map.set(e,n),n}}]),e}());var _=function(){var e=Object(c.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1],l=Object(c.useState)(),s=Object(i.a)(l,2),r=s[0],o=s[1],j=Object(c.useState)(),h=Object(i.a)(j,2),O=h[0],f=h[1],v=Object(c.useState)([]),m=Object(i.a)(v,2),g=m[0],p=m[1],y=void 0===O?[]:B.get(r.Sheets[O]);return Object(C.jsx)(b.a,{children:Object(C.jsxs)(x.a,{spacing:2,children:[Object(C.jsx)(S,{setWorkbook:o,setFilename:a}),Object(C.jsx)(w,{sheets:void 0===r?[]:r.SheetNames,onChange:f}),Object(C.jsx)(k,{columns:y,onChange:p}),Object(C.jsx)(d.a,{variant:"contained",onClick:function(){console.log(O),function(e,t){var n,c=F.a.utils.decode_range(e["!ref"]),a=Object(u.a)(t);try{for(a.s();!(n=a.n()).done;){var l=n.value;console.log("Converting column ".concat(JSON.stringify(l)));for(var s=c.s.r+1;s<=c.e.r;++s){var r=e[F.a.utils.encode_cell({c:l.id,r:s})];void 0!==r&&void 0!==r.w&&(r.v=r.w.replace(/(^(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)([\u4E00\u4E03\u4E07\u4E09\u4E5D\u4E8C\u4E94\u516B\u516D\u5341\u5343\u56DB\u767E\u96F6]+)\u5E97$/,(function(e,t,n){var c=E.a.decodeS(n);return"".concat(t).concat(c.toString().padStart(2,"0"),"\u5e97")})),console.log("".concat(r.w," -> ").concat(r.v)),delete r.w)}}}catch(o){a.e(o)}finally{a.f()}}(r.Sheets[O],g);var e=F.a.write(r,{type:"array"}),t=new Blob([e],{type:"application/vnd.ms-excel"}),c=URL.createObjectURL(t),a=document.createElement("a");a.style.display="none",a.href=c,a.target="_blank",a.download=n,document.body.appendChild(a),a.click(),document.body.removeChild(a)},disabled:[r,O,g].some((function(e){return void 0===e})),children:"\u8f6c\u6362\u5e76\u4e0b\u8f7d"})]})})};s.a.render(Object(C.jsx)(a.a.StrictMode,{children:Object(C.jsx)(_,{})}),document.getElementById("root"))},67:function(e,t){},90:function(e,t){},91:function(e,t){}},[[102,1,2]]]);
//# sourceMappingURL=main.5738204c.chunk.js.map