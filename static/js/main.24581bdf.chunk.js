(this["webpackJsonpconvert-numbers"]=this["webpackJsonpconvert-numbers"]||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),l=n(29),s=n.n(l),u=n(44),i=n(45),o=n(12),r=n(162),d=n(163),b=n(161),j=n(157),h=n(160),O=n(158),f=n(156),v=n(153),x=n(152),m=n(154),g=n(33),p=n.n(g),F=n(70),E=n.n(F),S=n(2),D=Object(m.a)({button:{height:"100%",contained:!0}});function y(e){var t=e.setWorkbook,n=e.setFilename,a=D(),l=Object(c.useState)("\u9009\u62e9\u8981\u8f6c\u6362\u7684Excel\u6587\u4ef6"),s=Object(o.a)(l,2),u=s[0],i=s[1];return Object(S.jsxs)(h.a,{container:!0,spacing:2,children:[Object(S.jsx)(h.a,{item:!0,xs:10,children:Object(S.jsx)(b.a,{value:u,inputProps:{style:{padding:"16.5px 14px"}},readOnly:!0,disableUnderline:!0,fullWidth:!0})}),Object(S.jsx)(h.a,{item:!0,xs:2,children:Object(S.jsxs)(r.a,{variant:"contained",component:"label",className:a.button,fullWidth:!0,children:["\u4e0a\u4f20",Object(S.jsx)("input",{type:"file",accept:".xls,.xlsx",onChange:function(e){if(0!==e.target.files.length){var c=e.target.files[0];n(c.name);var a=new FileReader;a.onload=function(e){var n=e.target.result,a=p.a.read(n,{type:"array"});i("".concat(c.name," \u4e0a\u4f20\u5b8c\u6bd5")),t(a)},i("".concat(c.name," \u4e0a\u4f20\u4e2d...")),a.readAsArrayBuffer(c)}},hidden:!0})]})})]})}function C(e){var t=e.sheets,n=e.onChange,a=Object(c.useState)(),l=Object(o.a)(a,2),s=l[0],u=l[1],i=t.includes(s)?s:t[0];return Object(c.useEffect)((function(){s!==i&&u(i)}),[s,i]),Object(c.useEffect)((function(){void 0!==i&&n(i)}),[i,n]),void 0===i?Object(S.jsxs)(j.a,{fullWidth:!0,children:[Object(S.jsx)(O.a,{id:"sheet-select-label",children:"\u5de5\u4f5c\u8868"}),Object(S.jsx)(v.a,{labelId:"sheet-select-label",label:"\u5de5\u4f5c\u8868",value:"dummy",disabled:!0,children:Object(S.jsx)(f.a,{value:"dummy",children:"\u6ca1\u6709\u6709\u6548\u7684\u5de5\u4f5c\u8868\uff0c\u8bf7\u5148\u4e0a\u4f20\u5408\u6cd5\u7684Excel\u6587\u4ef6"},0)})]}):Object(S.jsxs)(j.a,{fullWidth:!0,children:[Object(S.jsx)(O.a,{id:"sheet-select-label",children:"\u5de5\u4f5c\u8868"}),Object(S.jsx)(v.a,{labelId:"sheet-select-label",label:"\u5de5\u4f5c\u8868",value:i,onChange:function(e){return u(e.target.value)},children:t.map((function(e,t){return Object(S.jsx)(f.a,{value:e,children:e},t)}))})]})}function w(e){var t=e.columns,n=e.onChange,a=Object(c.useState)(),l=Object(o.a)(a,2),s=l[0],u=l[1],i=t.includes(s)?s:t[0];return console.log("ColumnSelector: ".concat(JSON.stringify(s)," -> ").concat(JSON.stringify(i)),t),Object(c.useEffect)((function(){s!==i&&u(i)}),[s,i]),Object(c.useEffect)((function(){void 0!==i&&n(i)}),[i,n]),void 0===i?Object(S.jsxs)(j.a,{children:[Object(S.jsx)(O.a,{id:"column-select-label",children:"\u8981\u8f6c\u6362\u7684\u5217"}),Object(S.jsx)(v.a,{labelId:"column-select-label",label:"\u8981\u8f6c\u6362\u7684\u5217",value:"dummy",disabled:!0,children:Object(S.jsx)(f.a,{value:"dummy",children:"\u6ca1\u6709\u53ef\u7528\u7684\u5217\uff0c\u8bf7\u5148\u9009\u62e9\u53ef\u7528\u7684\u5de5\u4f5c\u8868"},0)})]}):Object(S.jsxs)(j.a,{children:[Object(S.jsx)(O.a,{id:"column-select-label",children:"\u8981\u8f6c\u6362\u7684\u5217"}),Object(S.jsx)(v.a,{labelId:"column-select-label",label:"\u8981\u8f6c\u6362\u7684\u5217",value:i,onChange:function(e){return u(e.target.value)},children:t.map((function(e){return Object(S.jsx)(f.a,{value:e,children:e.text},e.id)}))})]})}var k=new(function(){function e(){Object(u.a)(this,e),this.columns_map=new Map}return Object(i.a)(e,[{key:"get",value:function(e){console.log("start getting table headers");var t=this.columns_map.get(e);if(void 0!==t)return console.log("Cached!",t),t;console.log("Missed cache!",e);for(var n=[],c=p.a.utils.decode_range(e["!ref"]),a=c.s.c;a<=c.e.c;++a){var l=e[p.a.utils.encode_cell({c:a,r:c.s.r})];void 0!==l&&void 0!==l.w&&n.push({id:a,text:l.w})}return console.log("Result",n),this.columns_map.set(e,n),n}}]),e}());var B=function(){var e=Object(c.useState)(),t=Object(o.a)(e,2),n=t[0],a=t[1],l=Object(c.useState)(),s=Object(o.a)(l,2),u=s[0],i=s[1],b=Object(c.useState)(),j=Object(o.a)(b,2),h=j[0],O=j[1],f=Object(c.useState)(),v=Object(o.a)(f,2),m=v[0],g=v[1],F=void 0===h?[]:k.get(u.Sheets[h]);return Object(S.jsx)(d.a,{children:Object(S.jsxs)(x.a,{spacing:2,children:[Object(S.jsx)(y,{setWorkbook:i,setFilename:a}),Object(S.jsx)(C,{sheets:void 0===u?[]:u.SheetNames,onChange:O}),Object(S.jsx)(w,{columns:F,onChange:g}),Object(S.jsx)(r.a,{variant:"contained",onClick:function(){console.log(h),function(e,t){var n=p.a.utils.decode_range(e["!ref"]);console.log("Converting column ".concat(JSON.stringify(t)));for(var c=n.s.r+1;c<=n.e.r;++c){var a=e[p.a.utils.encode_cell({c:t.id,r:c})];void 0!==a&&void 0!==a.w&&(a.v=a.w.replace(/(^(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)([\u4E00\u4E03\u4E07\u4E09\u4E5D\u4E8C\u4E94\u516B\u516D\u5341\u5343\u56DB\u767E\u96F6]+)\u5E97$/,(function(e,t,n){var c=E.a.decodeS(n);return"".concat(t).concat(c.toString().padStart(2,"0"),"\u5e97")})),console.log("".concat(a.w," -> ").concat(a.v)),delete a.w)}}(u.Sheets[h],m),p.a.writeFile(u,n)},disabled:[u,h,m].some((function(e){return void 0===e})),children:"\u8f6c\u6362\u5e76\u4e0b\u8f7d"})]})})};s.a.render(Object(S.jsx)(a.a.StrictMode,{children:Object(S.jsx)(B,{})}),document.getElementById("root"))},67:function(e,t){},89:function(e,t){},90:function(e,t){}},[[101,1,2]]]);
//# sourceMappingURL=main.24581bdf.chunk.js.map